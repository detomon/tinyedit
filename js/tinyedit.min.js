!function(a,b){"use strict";function c(a){return l+a}function d(){var b=a.documentElement;return{x:a.body.scrollLeft+b.scrollLeft,y:a.body.scrollTop+b.scrollTop}}function e(a,b){var c=d();return a-=c.x,b-=c.y,{x:a,y:b}}function f(b,c,d){var f,g,h,i=e(c,d);if(c=i.x,d=i.y,a.caretPositionFromPoint)f=a.caretPositionFromPoint(c,d),g=f.offsetNode,h=f.offset;else{if(!a.caretRangeFromPoint)return calcTextOffsetFromPosition(b,c,d);f=a.caretRangeFromPoint(c,d),g=f.startContainer,h=f.startOffset}return{textNode:g,offset:h}}function g(a){for(;a.parentNode;){var b=a.parentNode;if(b&&b.classList&&b.classList.contains(c("container")))return a;a=b}return null}function h(b){var c=a.createElement("div"),d=a.createElement("div");return d.innerHTML=b,c.appendChild(d),c}function i(a,b){var c,d,e,f=Array.prototype.slice.call(arguments,1);for(c=0;c<f.length;c++){var e=f[c];for(d in e)e.hasOwnProperty(d)&&null!==e[d]&&void 0!==e[d]&&(a[d]=e[d])}return a}function j(d,e){var f=this;e=i({tabWidth:4,tabStyle:"hard",textarea:null,firstLineNumber:1,lineBreak:"\n",editable:!0},e),this.options=e,d.style.tabSize=e.tabWidth,this.deferred={funcs:[],timeout:null,run:function(a){var c=this;this.funcs.push(a),this.timeout||(this.timeout=b.setTimeout(function(){for(var a=0;a<c.funcs.length;a++)c.funcs[a]();c.funcs=[],c.timeout=null},0))}},this.cursors={list:[],remove:function(a){var b=this.list.indexOf(a);b>=0&&this.list.splice(b,1)},removeAll:function(){this.inputElement&&this.inputElement.removeEventListener("blur",this.inputBlur),this.list.forEach(function(a){var b=a.parentNode;if(b){for(b.removeChild(a);"div"!=b.nodeName.toLowerCase();)b=b.parentNode;b.normalize()}}),this.list=[]},create:function(){var b=a.createElement("span");return b.classList.add(c("cursor"),c("blink")),this.list.push(b),b},inputBlur:function(){f.cursors.removeAll()},createInputElement:function(){if(!this.inputElement){var b=a.createElement("textarea");b.setAttribute("wrap","off"),b.setAttribute("autocapitalize","off"),b.setAttribute("spellcheck","false"),b.classList.add(c("input")),this.inputElement=b}return this.inputElement},activateForInput:function(a){var b=this.createInputElement();a.appendChild(b),b.focus(),b.addEventListener("blur",this.inputBlur)},resetBlink:function(){var a=this;this.list.forEach(function(a){a.classList.remove(c("blink"))}),deferred.run(function(){a.list.forEach(function(a){a.classList.add(c("blink"))})})}},this.lines={element:null},this.gutter={element:null,update:function(){for(var b=this.element,c=b.childNodes.length,d=f.lines.element.childNodes.length;d>c;){var g=a.createElement("div");g.textContent=e.firstLineNumber+c,b.appendChild(g),c++}for(;c>d;)b.removeChild(b.lastChild),c--}},this.value=function(a){var b=this;a=i({tabWidth:b.options.tabWidth,tabStyle:b.options.tabStyle,lineBreak:b.options.lineBreak},a);for(var c=[],d=this.lines.element.children,e=0;e<d.length;e++)c.push(d[e].textContent);return c.join(a.lineBreak)};var g,h=a.createElement("div"),j=a.createElement("div"),k=a.createElement("div"),l=a.createElement("div");h.appendChild(k),j.appendChild(l),h.classList.add(c("content")),k.classList.add(c("content-inner"),c("container")),j.classList.add(c("gutter")),l.classList.add(c("gutter-inner"),c("container")),e.textarea?(g=e.textarea.value,textarea.style.display="none"):g=d.textContent,g=g.split(/\r?\n/m),g.forEach(function(a){var b=f.createLineElementFromRawLineContent(a);k.appendChild(b)}),this.lines.element=k,this.gutter.element=l,this.gutter.update(),d.innerHTML="",d.appendChild(j),d.appendChild(h),e.editable&&d.addEventListener("mousedown",function(a){f.handleMouseDownEvent(a)})}var k="tinyedit",l=k+"-",m=k+(1e7*Math.random()|0),n=j.prototype;n.createLineElementFromRawLineContent=function(a){return a=a.replace(/\s+$/g,""),a=a.replace(/\t/g,'<span class="'+c("tab")+'">	</span>'),h(a)},n.handleGutterClick=function(a,b){},n.handleTextClick=function(b,d){this.cursors.removeAll();var e=this,g=d.pageX,h=d.pageY,i=f(b,g,h);if(i){var j=i.textNode;if(j.parentNode.classList.contains(c("tab"))){var k=j.parentNode,l=k.getBoundingClientRect();e.cursors.removeAll();var m,n=e.cursors.create();return m=g>=l.left+.5*l.width?k.nextSibling:k,k.parentNode.insertBefore(n,m),void e.cursors.activateForInput(n)}j.classList&&j.classList.contains(c("cursor"))&&(j=j.nextSibling?j.nextSibling:j.parentNode.insertBefore(a.createTextNode(""),j),i.textNode=j);var n=e.cursors.create(),o=i.textNode;if("div"==o.nodeName.toLowerCase())o.appendChild(n);else if(0==i.offset)o.parentNode.insertBefore(n,o);else if(i.offset==i.textNode.nodeValue.length)o.parentNode.insertBefore(n,o.nextSibling);else{var p=i.textNode.splitText(i.offset);p.parentNode.insertBefore(n,p)}e.cursors.activateForInput(n)}},n.handleMouseDownEvent=function(a){var b=this,d=a.target;if(a.preventDefault(),d=g(d),!d)return null;var e=d.parentNode;e.classList.contains(c("content-inner"))?(d=d.querySelector("div"),b.handleTextClick(d,a)):e.classList.contains(c("gutter-inner"))&&b.handleGutterClick(d,a)},window.TinyEdit=function(a,b){if(!a||!a.parentNode||!a.ownerDocument)return null;if(!a[m]){var c=new j(a,b);a[m]=c}return a[m]}}(document,window);
//# sourceMappingURL=tinyedit.min.js.map